<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ëª¨ë²”ì‹ë‹¹ì—ì„œ ë°¥ë¨¹ìœ¼ë¼ê²Œ~</title>
</head>
<body>
    <h1 align="center">ğŸ´ëª¨ë²”ì‹ë‹¹ì—ì„œ ë°¥ë¨¹ìœ¼ë¼ê²Œ~ğŸœ</h1>
    <div id="map" align="center" style="width:100%;height:500px;"></div>
    <br>
    <table border="1" width="400" height="70" align="center">
        <th align="center" bgcolor="Crimson"><button type=button>í•œì‹</button></th>
        <th align="center" bgcolor="Orange"><button type=button>ì¼ì‹</button></th>
        <th align="center" bgcolor="Khaki"><button type=button>ì¤‘ì‹</button></th>
        <th align="center" bgcolor="LightPink"><button type=button>ê³ ê¸°</button></th>
        <th align="center" bgcolor="SeaGreen"><button type=button>íšŒ</button></th>
        <th align="center" bgcolor="DimGray"><button type=button>ê¸°íƒ€</button></th>
    </table>
    <h4 align="center">íƒë‚˜ëŠ” SW ì½”ë”©ëŒ€íšŒ</h4>
    <h5 align="center">ğŸŒ´ê¹€ë‹¤í˜„, ì–‘í˜„ì£¼ğŸŒ´</h5>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=686fb8e1d013ab9cd70720ab4622dbe0&libraries=services"></script>
    <script>
        const url = "https://api.odcloud.kr/api/15055981/v1/uddi:6d218756-7258-42b6-9ab6-d3f07effeb0d?page=1&perPage=240&serviceKey=VfxwJOiRK4Lubg%2BzpSfUrSZpPCdgWPxRzvzRQyBH76dJsrXQ8xmYY1xae3ObsrVrmsWNO7twRmauyRcM0yqY%2Fg%3D%3D";
        fetch(url)
            .then((res) => res.json())
            .then((myJson) => {
                var obj_key = Object.keys(myJson);
                var obj_value = myJson['data'];

                var count_h = 0,
                    count_j = 0,
                    count_c = 0,
                    count_m = 0,
                    count_f = 0,
                    count_g = 0;

                var h_name = []; //í•œì‹ ê°€ê²Œëª…
                var h_location = []; // í•œì‹ ì£¼ì†Œ
                var j_name = []; // ì¼ì‹ ê°€ê²Œëª…
                var j_location = []; // ì¼ì‹ ì£¼ì†Œ ...
                var c_name = [];
                var c_location = [];
                var m_name = [];
                var m_location = [];
                var f_name = [];
                var f_location = [];
                var g_name = [];
                var g_location = [];

                for (var i = 0; i < obj_value.length; i++) {
                    if (obj_value[i].ë©”ë‰´ == "í•œì‹") {
                        h_name[count_h] = obj_value[i].ì—…ì†Œëª…;
                        h_location[count_h] = obj_value[i].ì†Œì¬ì§€;
                        count_h++;
                    } else if (obj_value[i].ë©”ë‰´ == "ì¼ì‹") {
                        j_name[count_j] = obj_value[i].ì—…ì†Œëª…;
                        j_location[count_j] = obj_value[i].ì†Œì¬ì§€;
                        count_j++;
                    } else if (obj_value[i].ë©”ë‰´ == "ì¤‘êµ­ì‹") {
                        c_name[count_c] = obj_value[i].ì—…ì†Œëª…;
                        c_location[count_c] = obj_value[i].ì†Œì¬ì§€;
                        count_c++;
                    } else if (obj_value[i].ë©”ë‰´ == "ì‹ìœ¡(ìˆ¯ë¶ˆêµ¬ì´)") {
                        m_name[count_m] = obj_value[i].ì—…ì†Œëª…;
                        m_location[count_m] = obj_value[i].ì†Œì¬ì§€;
                        count_m++;
                    } else if (obj_value[i].ë©”ë‰´ == "íšŸì§‘") {
                        f_name[count_f] = obj_value[i].ì—…ì†Œëª…;
                        f_location[count_f] = obj_value[i].ì†Œì¬ì§€;
                        count_f++;
                    } else {
                        g_name[count_g] = obj_value[i].ì—…ì†Œëª…;
                        g_location[count_g] = obj_value[i].ì†Œì¬ì§€;
                        count_g++;
                    }
                }

                var mapContainer = document.getElementById('map'), // ì§€ë„ë¥¼ í‘œì‹œí•  div 
                    mapOption = {
                        center: new daum.maps.LatLng(33.450701, 126.570667), // ì§€ë„ì˜ ì¤‘ì‹¬ì¢Œí‘œ
                        level: 3 // ì§€ë„ì˜ í™•ëŒ€ ë ˆë²¨
                    };

                // ì§€ë„ë¥¼ ìƒì„±í•©ë‹ˆë‹¤    
                var map = new daum.maps.Map(mapContainer, mapOption);

                if (navigator.geolocation) {

                    // ì ‘ì† ìœ„ì¹˜ë¥¼ ì–»ì–´ì˜´
                    navigator.geolocation.getCurrentPosition(function(position) {

                        var lat = position.coords.latitude, // ìœ„ë„
                            lon = position.coords.longitude; // ê²½ë„

                        var locPosition = new kakao.maps.LatLng(lat, lon), // ë§ˆì»¤ê°€ í‘œì‹œë  ìœ„ì¹˜ ìƒì„±
                            message = '<div style="padding:5px;">í˜„ìœ„ì¹˜!</div>'; // í‘œì‹œí•  ë‚´ìš©

                        // ë§ˆì»¤ì™€ ì •ë³´ í‘œì‹œ
                        displayMarker(locPosition, message);

                    });

                } else { // ì ‘ì† ìœ„ì¹˜ë¥¼ ì–»ì–´ì˜¬ ìˆ˜ ì—†ì„ ë•Œ

                    var locPosition = new kakao.maps.LatLng(33.450701, 126.570667),
                        message = 'ì ‘ì† ìœ„ì¹˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤'

                    displayMarker(locPosition, message);
                }

                // ë§ˆì»¤ì™€ ì •ë³´ í‘œì‹œ
                function displayMarker(locPosition, message) {

                    // ë§ˆì»¤ ìƒì„±
                    var marker = new kakao.maps.Marker({
                        map: map,
                        position: locPosition
                    });

                    var iwContent = message, // ì¸í¬ìœˆë„ìš°ì— í‘œì‹œí•  ë‚´ìš©
                        iwRemoveable = true;

                    // ì¸í¬ìœˆë„ìš°ë¥¼ ìƒì„±
                    var infowindow = new kakao.maps.InfoWindow({
                        content: iwContent,
                        removable: iwRemoveable
                    });

                    // ì¸í¬ìœˆë„ìš°ë¥¼ ë§ˆì»¤ìœ„ì— í‘œì‹œ
                    infowindow.open(map, marker);

                    // ì§€ë„ ì¤‘ì‹¬ì¢Œí‘œë¥¼ ì ‘ì†ìœ„ì¹˜ë¡œ ë³€ê²½
                    map.setCenter(locPosition);
                }

                // ì£¼ì†Œ -> ì¢Œí‘œ ë³€í™˜ ê°ì²´ë¥¼ ìƒì„±
                var geocoder = new daum.maps.services.Geocoder();

                // ì´ë¯¸ì§€ íŒŒì¼
                var K_imageSrc = "images/red.png"; // í•œì‹
                var J_imageSrc = "images/orange.png"; // ì¼ì‹
                var C_imageSrc = "images/yellow.png"; // ì¤‘ì‹
                var M_imageSrc = "images/pink.png"; // ê³ ê¸°
                var F_imageSrc = "images/green.png"; // íšŒ
                var G_imageSrc = "images/black.png"; // ê¸°íƒ€

                // í•œì‹
                for (var i = 0; i < h_name.length; i++) {
                    var imageSize = new kakao.maps.Size(24, 35);
                    var markerImage1 = new kakao.maps.MarkerImage(K_imageSrc, imageSize);

                    // ì£¼ì†Œë¡œ ì¢Œí‘œë¥¼ ê²€ìƒ‰
                    geocoder.addressSearch(h_location[i], function(result, status) {

                        // ì •ìƒì ìœ¼ë¡œ ê²€ìƒ‰ì´ ì™„ë£Œëìœ¼ë©´ 
                        if (status === daum.maps.services.Status.OK) {

                            var coords = new daum.maps.LatLng(result[0].y, result[0].x);

                            // ê²°ê³¼ê°’ìœ¼ë¡œ ë°›ì€ ìœ„ì¹˜ë¥¼ ë§ˆì»¤ë¡œ í‘œì‹œ
                            var marker = new daum.maps.Marker({
                                map: map,
                                position: coords,
                                image: markerImage1
                            });


                        }
                    })
                };

                // ì¼ì‹
                for (var i = 0; i < j_name.length; i++) {

                    var imageSize = new kakao.maps.Size(24, 35);
                    var markerImage2 = new kakao.maps.MarkerImage(J_imageSrc, imageSize);

                    geocoder.addressSearch(j_location[i], function(result, status) {

                        if (status === daum.maps.services.Status.OK) {

                            var coords = new daum.maps.LatLng(result[0].y, result[0].x);

                            var marker = new daum.maps.Marker({
                                map: map,
                                position: coords,
                                image: markerImage2
                            });


                        }
                    })
                };

                // ì¤‘ì‹
                for (var i = 0; i < c_name.length; i++) {
                    var imageSize = new kakao.maps.Size(24, 35);
                    var markerImage3 = new kakao.maps.MarkerImage(C_imageSrc, imageSize);

                    geocoder.addressSearch(c_location[i], function(result, status) {

                        if (status === daum.maps.services.Status.OK) {

                            var coords = new daum.maps.LatLng(result[0].y, result[0].x);

                            var marker = new daum.maps.Marker({
                                map: map,
                                position: coords,
                                image: markerImage3
                            });


                        }
                    })
                };

                // ê³ ê¸°
                for (var i = 0; i < m_name.length; i++) {
                    var imageSize = new kakao.maps.Size(24, 35);
                    var markerImage4 = new kakao.maps.MarkerImage(M_imageSrc, imageSize);

                    geocoder.addressSearch(m_location[i], function(result, status) {

                        if (status === daum.maps.services.Status.OK) {

                            var coords = new daum.maps.LatLng(result[0].y, result[0].x);

                            var marker = new daum.maps.Marker({
                                map: map,
                                position: coords,
                                image: markerImage4
                            });

                        }
                    })
                };

                // íšŸì§‘
                for (var i = 0; i < f_name.length; i++) {
                    var imageSize = new kakao.maps.Size(24, 35);
                    var markerImage5 = new kakao.maps.MarkerImage(F_imageSrc, imageSize);

                    geocoder.addressSearch(f_location[i], function(result, status) {
 
                        if (status === daum.maps.services.Status.OK) {

                            var coords = new daum.maps.LatLng(result[0].y, result[0].x);

                            var marker = new daum.maps.Marker({
                                map: map,
                                position: coords,
                                image: markerImage5
                            });


                        }
                    })
                };

                //ê¸°íƒ€
                for (var i = 0; i < g_name.length; i++) {
                    var imageSize = new kakao.maps.Size(24, 35);
                    var markerImage6 = new kakao.maps.MarkerImage(G_imageSrc, imageSize);

                    geocoder.addressSearch(g_location[i], function(result, status) {

                        if (status === daum.maps.services.Status.OK) {

                            var coords = new daum.maps.LatLng(result[0].y, result[0].x);

                            var marker = new daum.maps.Marker({
                                map: map,
                                position: coords,
                                image: markerImage6
                            });
                        }
                    })
                };

            });
    </script>
</body>
</html>
